-- Lucky Paws Test Data
-- 테스트용 샘플 데이터 생성

-- 테스트 사용자 생성
INSERT INTO users (id, name, email, password, type, teacher_type, years_of_experience, bio, is_verified) VALUES
('550e8400-e29b-41d4-a716-446655440001', '김선생님', 'teacher1@test.com', '$2a$10$hashedpassword', 'mentor', 'elementary', 5, '초등학교 3학년 담임교사입니다. 학생들과 함께 성장하는 것을 좋아합니다.', true),
('550e8400-e29b-41d4-a716-446655440002', '이선생님', 'teacher2@test.com', '$2a$10$hashedpassword', 'mentor', 'middle', 8, '중학교 수학 교사입니다. 학생들의 수학 실력 향상을 위해 노력하고 있습니다.', true),
('550e8400-e29b-41d4-a716-446655440003', '박선생님', 'teacher3@test.com', '$2a$10$hashedpassword', 'mentor', 'high', 12, '고등학교 영어 교사입니다. 학생들의 영어 실력 향상과 진로 지도를 담당합니다.', true),
('550e8400-e29b-41d4-a716-446655440004', '최신입교사', 'newteacher@test.com', '$2a$10$hashedpassword', 'mentee', 'elementary', 1, '신입 교사입니다. 선배님들의 조언을 기다리고 있습니다.', false),
('550e8400-e29b-41d4-a716-446655440005', '정교사', 'teacher5@test.com', '$2a$10$hashedpassword', 'mentor', 'middle', 6, '중학교 과학 교사입니다. 실험 수업을 통해 학생들의 호기심을 키우고 싶습니다.', true);

-- 테스트 게시글 생성
INSERT INTO posts (id, title, content, author_id, category, teacher_level, tags) VALUES
('660e8400-e29b-41d4-a716-446655440001', '학급 규칙 세우기 조언 부탁드립니다', '신입 교사로서 학급 규칙을 어떻게 세워야 할지 고민입니다. 효과적인 학급 규칙 세우는 방법을 알려주세요.', '550e8400-e29b-41d4-a716-446655440004', '학생지도', '초등학교', ARRAY['학급규칙', '신입교사', '학생지도']),
('660e8400-e29b-41d4-a716-446655440002', '수학 수업에서 학생들의 집중력 향상 방법', '중학교 2학년 수학 수업에서 학생들의 집중력이 떨어지는 것 같습니다. 어떤 방법들이 효과적인지 경험담을 공유해주세요.', '550e8400-e29b-41d4-a716-446655440002', '수업운영', '중학교', ARRAY['수학수업', '집중력', '중학교']),
('660e8400-e29b-41d4-a716-446655440003', '학부모 상담 시 주의사항', '고등학교 담임을 맡게 되었는데, 학부모 상담 시 어떤 점들을 주의해야 하는지 궁금합니다.', '550e8400-e29b-41d4-a716-446655440003', '학부모상담', '고등학교', ARRAY['학부모상담', '고등학교', '담임']),
('660e8400-e29b-41d4-a716-446655440004', '효과적인 과제 평가 방법', '초등학교 3학년 국어 과제를 어떻게 평가하면 좋을지 고민입니다. 객관적이고 공정한 평가 방법을 알려주세요.', '550e8400-e29b-41d4-a716-446655440001', '평가/과제', '초등학교', ARRAY['과제평가', '국어', '초등학교']),
('660e8400-e29b-41d4-a716-446655440005', '동료 교사와의 원활한 소통 방법', '새로운 학교로 전근을 와서 동료 교사들과의 관계가 어색합니다. 어떻게 하면 더 원활하게 소통할 수 있을까요?', '550e8400-e29b-41d4-a716-446655440005', '동료관계', '중학교', ARRAY['동료관계', '전근', '소통']);

-- 테스트 댓글 생성
INSERT INTO comments (id, post_id, content, author_id) VALUES
('770e8400-e29b-41d4-a716-446655440001', '660e8400-e29b-41d4-a716-446655440001', '학급 규칙은 학생들과 함께 만들어보세요. 학생들이 직접 참여하면 더 잘 지켜집니다.', '550e8400-e29b-41d4-a716-446655440001'),
('770e8400-e29b-41d4-a716-446655440002', '660e8400-e29b-41d4-a716-446655440001', '규칙은 너무 많지 않게 3-5개 정도로 핵심적인 것만 정하는 것이 좋습니다.', '550e8400-e29b-41d4-a716-446655440002'),
('770e8400-e29b-41d4-a716-446655440003', '660e8400-e29b-41d4-a716-446655440002', '수학 수업에서 게임 요소를 도입해보세요. 카드 게임이나 퀴즈를 활용하면 학생들이 더 집중합니다.', '550e8400-e29b-41d4-a716-446655440005'),
('770e8400-e29b-41d4-a716-446655440004', '660e8400-e29b-41d4-a716-446655440003', '학부모 상담 시에는 구체적인 사례를 준비하시고, 학생의 장점부터 말씀하시는 것이 좋습니다.', '550e8400-e29b-41d4-a716-446655440001'),
('770e8400-e29b-41d4-a716-446655440005', '660e8400-e29b-41d4-a716-446655440004', '과제 평가는 루브릭을 미리 만들어서 학생들에게 공개하는 것이 좋습니다.', '550e8400-e29b-41d4-a716-446655440002');

-- 테스트 반응 생성
INSERT INTO reactions (id, post_id, user_id, type) VALUES
('880e8400-e29b-41d4-a716-446655440001', '660e8400-e29b-41d4-a716-446655440001', '550e8400-e29b-41d4-a716-446655440001', 'empathy'),
('880e8400-e29b-41d4-a716-446655440002', '660e8400-e29b-41d4-a716-446655440001', '550e8400-e29b-41d4-a716-446655440002', 'helpful'),
('880e8400-e29b-41d4-a716-446655440003', '660e8400-e29b-41d4-a716-446655440002', '550e8400-e29b-41d4-a716-446655440003', 'cheer'),
('880e8400-e29b-41d4-a716-446655440004', '660e8400-e29b-41d4-a716-446655440003', '550e8400-e29b-41d4-a716-446655440004', 'empathy'),
('880e8400-e29b-41d4-a716-446655440005', '660e8400-e29b-41d4-a716-446655440004', '550e8400-e29b-41d4-a716-446655440005', 'helpful');

-- 테스트 좋아요 생성
INSERT INTO likes (id, target_id, target_type, user_id) VALUES
('990e8400-e29b-41d4-a716-446655440001', '660e8400-e29b-41d4-a716-446655440001', 'post', '550e8400-e29b-41d4-a716-446655440001'),
('990e8400-e29b-41d4-a716-446655440002', '660e8400-e29b-41d4-a716-446655440002', 'post', '550e8400-e29b-41d4-a716-446655440002'),
('990e8400-e29b-41d4-a716-446655440003', '770e8400-e29b-41d4-a716-446655440001', 'comment', '550e8400-e29b-41d4-a716-446655440003'),
('990e8400-e29b-41d4-a716-446655440004', '770e8400-e29b-41d4-a716-446655440002', 'comment', '550e8400-e29b-41d4-a716-446655440004'),
('990e8400-e29b-41d4-a716-446655440005', '660e8400-e29b-41d4-a716-446655440003', 'post', '550e8400-e29b-41d4-a716-446655440005');

-- 테스트 채팅방 생성
INSERT INTO chat_rooms (id) VALUES
('aa0e8400-e29b-41d4-a716-446655440001'),
('aa0e8400-e29b-41d4-a716-446655440002');

-- 테스트 채팅방 참여자 생성
INSERT INTO chat_room_participants (id, room_id, user_id) VALUES
('bb0e8400-e29b-41d4-a716-446655440001', 'aa0e8400-e29b-41d4-a716-446655440001', '550e8400-e29b-41d4-a716-446655440001'),
('bb0e8400-e29b-41d4-a716-446655440002', 'aa0e8400-e29b-41d4-a716-446655440001', '550e8400-e29b-41d4-a716-446655440004'),
('bb0e8400-e29b-41d4-a716-446655440003', 'aa0e8400-e29b-41d4-a716-446655440002', '550e8400-e29b-41d4-a716-446655440002'),
('bb0e8400-e29b-41d4-a716-446655440004', 'aa0e8400-e29b-41d4-a716-446655440002', '550e8400-e29b-41d4-a716-446655440005');

-- 테스트 채팅 메시지 생성
INSERT INTO chat_messages (id, room_id, sender_id, content) VALUES
('cc0e8400-e29b-41d4-a716-446655440001', 'aa0e8400-e29b-41d4-a716-446655440001', '550e8400-e29b-41d4-a716-446655440001', '안녕하세요! 신입 교사 선생님이시군요. 궁금한 점이 있으시면 언제든 물어보세요.'),
('cc0e8400-e29b-41d4-a716-446655440002', 'aa0e8400-e29b-41d4-a716-446655440001', '550e8400-e29b-41d4-a716-446655440004', '감사합니다! 정말 도움이 많이 될 것 같아요.'),
('cc0e8400-e29b-41d4-a716-446655440003', 'aa0e8400-e29b-41d4-a716-446655440002', '550e8400-e29b-41d4-a716-446655440002', '수학 수업에 대해 이야기해볼까요?'),
('cc0e8400-e29b-41d4-a716-446655440004', 'aa0e8400-e29b-41d4-a716-446655440002', '550e8400-e29b-41d4-a716-446655440005', '네, 좋습니다! 어떤 부분이 궁금하신가요?');

-- 게시글 카운트 업데이트
UPDATE posts SET 
  comment_count = (SELECT COUNT(*) FROM comments WHERE post_id = posts.id),
  like_count = (SELECT COUNT(*) FROM likes WHERE target_id = posts.id AND target_type = 'post');

-- 댓글 카운트 업데이트
UPDATE comments SET 
  like_count = (SELECT COUNT(*) FROM likes WHERE target_id = comments.id AND target_type = 'comment');

-- 채팅방 마지막 메시지 업데이트
UPDATE chat_rooms SET 
  last_message_id = (
    SELECT id FROM chat_messages 
    WHERE room_id = chat_rooms.id 
    ORDER BY created_at DESC 
    LIMIT 1
  );

SELECT 'Test data created successfully!' as status; 